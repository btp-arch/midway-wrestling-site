---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Section from "../../components/Section.astro";
import CTAButtons from "../../components/CTAButtons.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const entries = await getCollection("news");
  return entries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();

const formattedDate = entry.data.date.toLocaleDateString("en-US", {
  month: "long",
  day: "numeric",
  year: "numeric",
  timeZone: "UTC",
});
---

<BaseLayout
  title={`${entry.data.title} | Midway Wrestling Club`}
  description={entry.data.excerpt}
>
  <Section title={entry.data.title} intro={entry.data.excerpt} headingTag="h1">
    <a slot="eyebrow" class="eyebrow-link" href="/news" aria-label="Back to news">
      <span class="eyebrow-link__icon" aria-hidden="true">‚Üê</span>
      Back to News
    </a>
    <article class="article">
      <div class="article-meta">
        <span>{formattedDate}</span>
        {entry.data.author && <span>{entry.data.author}</span>}
      </div>
      {entry.data.cover &&
        (entry.data.coverStyle === "logo" ? (
          <div class="article-cover-frame article-cover-frame--logo">
            <img
              class="article-cover__img article-cover__img--logo"
              src={entry.data.cover}
              alt=""
              loading="lazy"
              decoding="async"
            />
          </div>
        ) : (
          <div class="article-cover-frame">
            <img
              class="article-cover__img"
              src={entry.data.cover}
              alt=""
              loading="lazy"
              decoding="async"
            />
          </div>
        ))}
      <div class="article-content">
        <Content />
      </div>
    </article>
  </Section>

  <Section
    eyebrow="Stay connected"
    title="More updates coming"
    intro="Join updates or contact the coaches with questions."
  >
    <CTAButtons
      primaryLabel="Call/Text Coach"
      primaryHref="tel:+19704242757"
      secondaryLabel="Join Updates"
      secondaryHref="/join"
      secondaryVariant="outline"
    />
  </Section>
</BaseLayout>
